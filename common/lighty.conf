#
#  This file is an example configuration file for ARAS driving the LightHead
# robotic system.
#

#  If you experience a crash (ie: an Exception), you can investigate the reasons
# setting VERBOSITY to DEBUG, spawning then the convenient python debugger.
VERBOSITY = 2      # 0: WARNING, 1: INFO, 2: DEBUG    (default is 0)

################################################################################
# Network Connections: Listening IP address , Port
#
# = ('','/tmp/lightHead')	         # using a UNIX socket
# = ('localhost', 31337)		 # using the loopback TCP interface
# = ('192.168.0.3', 31337)		 # using the LAN
################################################################################

#  This software: ARAS (Abstract Robotic Animation System), providing generic
# animation features abstracting hardware design.
#lightHead_server = ('192.168.56.1', 31337)		# using VirtualBox Linux
lightHead_server = ('10.1.10.102', 31337)		# using VirtualBox Linux

################################################################################
# Robot configuration
#
#  Hardware configuration is defined by the ROBOT dictionnary.
# This config file shows how to hold multiple robot configurations so to easily
# switch from one to another. e.g: for testing or on hardware failure..
#
#  Some entries refer to the lib_.. modules defined in the hardware library (in
# this file).
################################################################################

BLENDER_PROJ = (				# projection matrix
  ( 5. ,  .25,   .0,   .7),
  (-0.3, 9.40,   .0,  1.9),
  (-0.1, 0.  , -0.1, -0.2),
  (-0.1, 0.  , -1.0,  5.0) 
)

BLENDER_SPINE_SOFT = {
  'backend'       : 'blender',
  'proj_matrix'   : BLENDER_PROJ,
  # entry used for registering more protocol keywords for a subserver/handler
  'extra_origins' : ('spine',),
  'comm'          : ('localhost', 4242)		# standalone server info
}
BLENDER_SPINE_HARD = {
  'backend'       : 'blender',
  'proj_matrix'   : BLENDER_PROJ,
  # entry used for registering more protocol keywords for a subserver/handler
  'comm'          : ('localhost', 4242)		# standalone server info
}
VISION = {
  'backend'	  : None,			# no module to load.
  'sensor'        : 'laptop',
  'remote'        : ('my_host_connected_to_the_robot_camera', 4244),
  'haar_cascade'  : None,			# default or your own file path
}
SPINE = {
  'backend'       : 'katHD400s_6M',
  'hardware_addr' : '192.168.168.232',		# the robot arm IP address
  'comm'          : ('localhost', 4243),	# standalone server info
}

# Building 2 configuration presets
ROBOT_SOFT = {'name':'lightHead',
  'mod_face':BLENDER_SPINE_SOFT, 
  'vision': VISION, 
  'audition': 'laptop',
  'mod_spine': None}#SPINE }
ROBOT_HARD = {'name'      : 'lightHead',
  'mod_face'  : BLENDER_SPINE_HARD,
  'vision': VISION, #None,
  'mod_spine' : SPINE }

# Actual configuration
ROBOT = ROBOT_SOFT

################################################################################
# Hardware library
#
# Content is module-dependent
################################################################################

lib_vision = {
  'laptop' : {
	       'dev_index': 0,
	       'XY_factors': (.5, .1),
	       'depth_fct' : "0.105*x**-1.364",
	       'resolution': (320,240)
	            }
}

lib_audition = {
  'laptop' : { 'dev_index' : (6,6),	# stereo capable
  	       'ev_threshold': .1,
  	   }
}

lib_spine = {
		# floats are normalized angles
  'katHD400s_6M': {	# THIS SECTION IS *ONLY* FOR THE KATANA ARM HD400s_6M

		'AXIS_LIMITS' : {			# software axis range
         	 	'TX'  :(-.3 ,  .1 ),
         	 	'TZ'  :(-.5 ,  .5 ),
         	 	'53.5':(-.12 , .6, True),	# extra: inversed rot.
         	 	'55.5':(-.25,  .25),
         	 	'51.5':(-.4 ,  .4, True)
			},
		
		 # switch_off pose, absolute encoder values
		'POSE_REST' : (6350, 5600, 1800, 24900, None, None),

		 # operating basic pose, taken when system is ready
		'POSE_READY_NEUTRAL': (6350, -8500, -7500, 27300, None, None),
		},

  'blender' :   {	# Purely virtual character
                'AXIS_LIMITS' : {
                        '51.5' : (-15*0.01745, 15*0.01745),
                        '53.5' : (-22*0.01745, 25*0.01745),
                        '55.5' : (-15*0.01745, 15*0.01745),
                        'TX'   : (-20*0.01745, 30*0.01745),
                        'TY'   : (-17*0.01745, 15*0.01745),
                        'TZ'   : (-15*0.01745, 15*0.01745),
                        'SY'   : (-17*0.01745, 15*0.01745),
                        'SZ'   : (-17*0.01745, 15*0.01745)
                        }
                    }
}
